<!-- Breadcrumb Navigation per SEO e UX -->
<nav aria-label="breadcrumb" class="breadcrumb-container">
  <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
    <li class="breadcrumb-item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
  <a href="{{ '/' | relative_url }}" itemprop="item" itemtype="http://schema.org/WebPage">
        <span itemprop="name">Home</span>
      </a>
      <meta itemprop="position" content="1" />
    </li>
    
    {% if page.categories or page.category or page.cluster or page.cluster_name %}
  {% assign category = nil %}
  {% if page.category and page.category != "" %}
    {% assign category = page.category %}
  {% elsif page.categories and page.categories.size > 0 %}
    {% assign category = page.categories[0] %}
  {% elsif page.cluster and page.cluster != "" %}
    {% assign category = page.cluster %}
  {% elsif page.cluster_name and page.cluster_name != "" %}
    {% assign category = page.cluster_name %}
  {% endif %}
  {% assign key = category | default: '' | downcase | slugify %}
  {%- comment -%} Compute canonical category URL: prefer explicit mapping, otherwise build a safe path under /categorie/ {%- endcomment -%}
  {% assign mapped = site.data.category_slugs[key] | default: nil %}
  {% if mapped %}
    {% assign category_url = mapped | absolute_url %}
  {% else %}
      {% assign category_path = '/categorie/' | append: key | append: '/' %}
      {% assign category_url = category_path | absolute_url %}
  {% endif %}
      <li class="breadcrumb-item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
        <a href="{{ category_url }}" itemprop="item" itemtype="http://schema.org/WebPage">
          <span itemprop="name">{{ category | replace: '-', ' ' | capitalize }}</span>
        </a>
        <meta itemprop="position" content="2" />
      </li>
      {%- comment -%}
        Handle optional subcluster in page front-matter: try to resolve via site.data.subcluster_slugs
      {%- endcomment -%}
      {% if page.subcluster %}
        {% assign sub_clean = page.subcluster | downcase | slugify | strip %}
        {% assign subkey = key | append: ':' | append: sub_clean %}
        {% assign mapped_sub = site.data.subcluster_slugs[subkey] | default: nil %}
        {% if mapped_sub %}
          {% assign sub_url = mapped_sub | absolute_url %}
        {% else %}
          {% assign sub_path = '/categorie/' | append: key | append: '/' | append: sub_clean | append: '/' %}
          {% assign sub_url = sub_path | absolute_url %}
        {% endif %}
        <li class="breadcrumb-item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
          <a href="{{ sub_url }}" itemprop="item" itemtype="http://schema.org/WebPage">
            <span itemprop="name">{{ page.subcluster | replace: '-', ' ' | capitalize }}</span>
          </a>
          <meta itemprop="position" content="3" />
        </li>
      {% endif %}
    {% endif %}
    
    {% if page.layout == 'post' %}
      <li class="breadcrumb-item active" aria-current="page" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
        <span itemprop="name">{{ page.title | truncate: 50 }}</span>
        <meta itemprop="position" content="3" />
      </li>
    {% elsif page.title and page.title != site.title %}
      <li class="breadcrumb-item active" aria-current="page" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
        <span itemprop="name">{{ page.title }}</span>
        {%- assign title_pos = 2 -%}
        {%- if page.subcluster -%}
          {%- assign title_pos = title_pos | plus: 1 -%}
        {%- endif -%}
        <meta itemprop="position" content="{{ title_pos }}" />
      </li>
    {% endif %}
  </ol>
</nav>

<style>
.breadcrumb-container {
  background: transparent;
  padding: 0.5rem 0;
  margin-bottom: 1rem;
}

.breadcrumb {
  background: transparent;
  padding: 0;
  margin: 0;
  font-size: 0.9rem;
}

.breadcrumb-item + .breadcrumb-item::before {
  content: "â€º";
  color: #6c757d;
  margin: 0 0.5rem;
}

.breadcrumb-item a {
  color: #007bff;
  text-decoration: none;
}

.breadcrumb-item a:hover {
  text-decoration: underline;
}

.breadcrumb-item.active {
  color: #6c757d;
}
</style>
