<!-- Componente per immagini ottimizzate -->
{% assign img_path = include.src | default: '/img/default-post.jpg' %}
{% assign img_alt = include.alt | default: include.title | default: page.title | default: site.title | default: 'Immagine articolo' %}
{% assign img_class = include.class | default: "img-fluid" %}

{% comment %} Solo crea WebP se il file esiste {% endcomment %}
{% assign webp_path = img_path | replace: '.jpg', '.webp' | replace: '.jpeg', '.webp' | replace: '.png', '.webp' %}

<picture>
  <!-- WebP per browser moderni -->
  {% if img_path and img_path != '' %}
  <source 
    srcset="{{ webp_path }}" 
    type="image/webp">
  {% endif %}
  
  <!-- Fallback originale -->
  <!-- Fallback originale -->
  <img 
    src="{{ img_path }}" 
    alt="{{ img_alt }}" 
    {% if include.class %}class="{{ include.class }}"{% endif %}
    {% if include.loading %}loading="{{ include.loading }}"{% else %}loading="lazy"{% endif %}
    {% if include.loading == 'eager' %}fetchpriority="high"{% endif %}
    decoding="async"
    {% if include.width and include.height %}
    width="{{ include.width }}"
    height="{{ include.height }}"
    style="aspect-ratio: {{ include.width }}/{{ include.height }}; max-width: 100%; height: auto;"
    {% else %}
    style="max-width: 100%; height: auto; aspect-ratio: 16/9;"
    {% endif %}>
</picture>
