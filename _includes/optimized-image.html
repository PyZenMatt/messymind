<!-- Componente per immagini ottimizzate -->
{% assign img_path = include.src | default: '/img/default-post.jpg' %}
{% assign img_alt = include.alt | default: include.title | default: 'Immagine articolo' %}
{% assign img_class = include.class | default: "img-fluid" %}

{% comment %} Solo crea WebP se il file esiste {% endcomment %}
{% assign webp_path = img_path | replace: '.jpg', '.webp' | replace: '.jpeg', '.webp' | replace: '.png', '.webp' %}

<picture>
  <!-- WebP per browser moderni -->
  {% if img_path and img_path != '' %}
  <source 
    srcset="{{ webp_path }}" 
    type="image/webp">
  {% endif %}
  
  <!-- Fallback originale -->
  <img 
    src="{{ img_path }}" 
    alt="{{ img_alt }}" 
    class="{{ img_class }}"
    loading="{{ include.loading | default: 'lazy' }}"
    decoding="async"
    {% if include.width %}width="{{ include.width }}"{% endif %}
    {% if include.height %}height="{{ include.height }}"{% endif %}
    {% if include.width and include.height %}style="aspect-ratio: {{ include.width }}/{{ include.height }};"{% endif %}>
</picture>
